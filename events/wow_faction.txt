namespace = faction_changes

#Trigger these on taking decision
#Alliance Opnions Plus
country_event = {
  id = faction_changes.1
  title = faction_changes.1.t
  desc = faction_changes.1.d
  picture = BLIND_PALADIN_eventPicture

  major = yes
  trigger = {
    has_country_modifier = alliance_member
  }

  is_triggered_only = yes

  immediate = {
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = alliance_alliance } }
      }
      add_opinion = { who = ROOT modifier = alliance_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = alliance_horde } }
      }
      add_opinion = { who = ROOT modifier = alliance_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = alliance_neutral } }
      }
      add_opinion = { who = ROOT modifier = alliance_neutral }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        NOT = { has_opinion_modifier = { who = ROOT modifier = alliance_creep } }
      }
      add_opinion = { who = ROOT modifier = alliance_creep }
    }
  }

  option = {
    name = faction_changes.1.a
  }
}

#Horde Opinions Plus
country_event = {
  id = faction_changes.2
  title = faction_changes.2.t
  desc = faction_changes.2.d
  picture = ORC_SHAMAN_eventPicture

  major = yes
  trigger = {
    has_country_modifier = horde_member
  }

  is_triggered_only = yes

  immediate = {
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = horde_alliance } }
      }
      add_opinion = { who = ROOT modifier = horde_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = horde_horde } }
      }
      add_opinion = { who = ROOT modifier = horde_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = horde_neutral } }
      }
      add_opinion = { who = ROOT modifier = horde_neutral }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        NOT = { has_opinion_modifier = { who = ROOT modifier = horde_creep } }
      }
      add_opinion = { who = ROOT modifier = horde_creep }
    }
  }

  option = {
    name = faction_changes.2.a
  }
}

#Neutral Opinions Plus
country_event = {
  id = faction_changes.3
  title = faction_changes.3.t
  desc = faction_changes.3.d
  picture = MAGI_eventPicture

  major = yes
  trigger = {
    has_country_modifier = neutral_member
  }

  is_triggered_only = yes

  immediate = {
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = neutral_alliance } }
      }
      add_opinion = { who = ROOT modifier = neutral_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = neutral_horde } }
      }
      add_opinion = { who = ROOT modifier = neutral_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        NOT = { has_opinion_modifier = { who = ROOT modifier = neutral_neutral } }
      }
      add_opinion = { who = ROOT modifier = neutral_neutral }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        NOT = { has_opinion_modifier = { who = ROOT modifier = neutral_creep } }
      }
      add_opinion = { who = ROOT modifier = neutral_creep }
    }
  }

  option = {
    name = faction_changes.3.a
  }
}

#Alliance Opinions Minus
country_event = {
  id = faction_changes.4
  title = faction_changes.4.t
  desc = faction_changes.4.d
  picture = BLIND_PALADIN_eventPicture

  major = yes
  trigger = {
    NOT = { has_country_modifier = alliance_member }
  }

  is_triggered_only = yes

  immediate = {
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        has_opinion_modifier = { who = ROOT modifier = alliance_alliance }
      }
      remove_opinion = { who = ROOT modifier = alliance_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        reverse_has_opinion_modifier = { who = ROOT modifier = alliance_alliance }
      }
      reverse_remove_opinion = { who = ROOT modifier = alliance_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        has_opinion_modifier = { who = ROOT modifier = alliance_horde }
      }
      remove_opinion = { who = ROOT modifier = alliance_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        reverse_has_opinion_modifier = { who = ROOT modifier = alliance_horde }
      }
      reverse_remove_opinion = { who = ROOT modifier = alliance_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        has_opinion_modifier = { who = ROOT modifier = alliance_neutral }
      }
      remove_opinion = { who = ROOT modifier = alliance_neutral }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        reverse_has_opinion_modifier = { who = ROOT modifier = alliance_neutral }
      }
      reverse_remove_opinion = { who = ROOT modifier = alliance_neutral }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        has_opinion_modifier = { who = ROOT modifier = alliance_creep }
      }
      remove_opinion = { who = ROOT modifier = alliance_creep }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        reverse_has_opinion_modifier = { who = ROOT modifier = alliance_creep }
      }
      reverse_remove_opinion = { who = ROOT modifier = alliance_creep }
    }
  }

  option = {
    name = faction_changes.4.a
  }
}

#Horde Opinions Minus
country_event = {
  id = faction_changes.5
  title = faction_changes.5.t
  desc = faction_changes.5.d
  picture = ORC_SHAMAN_eventPicture

  major = yes
  trigger = {
    NOT = { has_country_modifier = horde_member }
  }

  is_triggered_only = yes

  immediate = {
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        has_opinion_modifier = { who = ROOT modifier = horde_alliance }
      }
      remove_opinion = { who = ROOT modifier = horde_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        reverse_has_opinion_modifier = { who = ROOT modifier = horde_alliance }
      }
      reverse_remove_opinion = { who = ROOT modifier = horde_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        has_opinion_modifier = { who = ROOT modifier = horde_horde }
      }
      remove_opinion = { who = ROOT modifier = horde_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        reverse_has_opinion_modifier = { who = ROOT modifier = horde_horde }
      }
      reverse_remove_opinion = { who = ROOT modifier = horde_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        has_opinion_modifier = { who = ROOT modifier = horde_neutral }
      }
      remove_opinion = { who = ROOT modifier = horde_neutral }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        reverse_has_opinion_modifier = { who = ROOT modifier = horde_neutral }
      }
      reverse_remove_opinion = { who = ROOT modifier = horde_neutral }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        has_opinion_modifier = { who = ROOT modifier = horde_creep }
      }
      remove_opinion = { who = ROOT modifier = horde_creep }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        reverse_has_opinion_modifier = { who = ROOT modifier = horde_creep }
      }
      reverse_remove_opinion = { who = ROOT modifier = horde_creep }
    }
  }

  option = {
    name = faction_changes.5.a
  }
}

#Neutral Opinions Minus
country_event = {
  id = faction_changes.6
  title = faction_changes.6.t
  desc = faction_changes.6.d
  picture = MAGI_eventPicture

  major = yes
  trigger = {
    has_country_modifier = neutral_member
  }

  is_triggered_only = yes

  immediate = {
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        has_opinion_modifier = { who = ROOT modifier = neutral_alliance }
      }
      remove_opinion = { who = ROOT modifier = neutral_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = alliance_member
        reverse_has_opinion_modifier = { who = ROOT modifier = neutral_alliance }
      }
      reverse_remove_opinion = { who = ROOT modifier = neutral_alliance }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        has_opinion_modifier = { who = ROOT modifier = neutral_horde }
      }
      remove_opinion = { who = ROOT modifier = neutral_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = horde_member
        reverse_has_opinion_modifier = { who = ROOT modifier = neutral_horde }
      }
      reverse_remove_opinion = { who = ROOT modifier = neutral_horde }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        has_opinion_modifier = { who = ROOT modifier = neutral_neutral }
      }
      remove_opinion = { who = ROOT modifier = neutral_neutral }
    }
    every_country = {
      limit = {
        has_country_modifier = neutral_member
        reverse_has_opinion_modifier = { who = ROOT modifier = neutral_neutral }
      }
      reverse_remove_opinion = { who = ROOT modifier = neutral_neutral }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        has_opinion_modifier = { who = ROOT modifier = neutral_creep }
      }
      remove_opinion = { who = ROOT modifier = neutral_creep }
    }
    every_country = {
      limit = {
        NOT = { has_country_modifier = alliance_member }
        NOT = { has_country_modifier = horde_member }
        NOT = { has_country_modifier = neutral_member }
        reverse_has_opinion_modifier = { who = ROOT modifier = neutral_creep }
      }
      reverse_remove_opinion = { who = ROOT modifier = neutral_creep }
    }
  }

  option = {
    name = faction_changes.6.a
  }
}

#Lose Alliance Membership - Evil
country_event = {
  id = faction_changes.7
  title = faction_changes.7.t
  desc = faction_changes.7.d
  picture = KAELTHAS_CLOSE_eventPicture

  major = yes
  trigger = {
    is_evil = yes
    has_country_modifier = alliance_member
  }

  is_triggered_only = yes

  immediate = {
    remove_country_modifier = alliance_member
  }

  option = {
    name = faction_changes.7.a
    country_event = { id = faction_changes.4 }
  }
}

#Lose Alliance Membership - Vassal
country_event = {
  id = faction_changes.8
  title = faction_changes.8.t
  desc = faction_changes.8.d
  picture = LOTHAR_FIRE_eventPicture

  major = yes
  trigger = {
    is_subject = true
    has_country_modifier = alliance_member
  }

  mean_time_to_happen = {
    days = 0
  }

  immediate = {
    remove_country_modifier = alliance_member
  }

  option = {
    name = faction_changes.8.a
    country_event = { id = faction_changes.4 }
  }
}

#Lose Horde Membership - Evil
country_event = {
  id = faction_changes.9
  title = faction_changes.9.t
  desc = faction_changes.9.d
  picture = BLOODLUST_eventPicture

  major = yes
  trigger = {
    is_evil = true
    has_country_modifier = horde_member
  }

  is_triggered_only = yes

  immediate = {
    remove_country_modifier = horde_member
  }

  option = {
    name = faction_changes.9.a
    country_event = { id = faction_changes.5 }
  }
}

#Lose Horde Membership - Vassal
country_event = {
  id = faction_changes.10
  title = faction_changes.10.t
  desc = faction_changes.10.d
  picture = INTERNMENT_CAMP_eventPicture

  major = yes
  trigger = {
    is_subject = true
    has_country_modifier = horde_member
  }

  mean_time_to_happen = {
    days = 0
  }

  immediate = {
    remove_country_modifier = horde_member
  }

  option = {
    name = faction_changes.10.a
    country_event = { id = faction_changes.5 }
  }
}

#Lose Neutrality - Evil
country_event = {
  id = faction_changes.11
  title = faction_changes.11.t
  desc = faction_changes.11.d
  picture = BLOODYCROWN_SKULLS_eventPicture

  major = yes
  trigger = {
    is_evil = true
    has_country_modifier = neutral_member
  }

  is_triggered_only = yes

  immediate = {
    remove_country_modifier = neutral_member
  }

  option = {
    name = faction_changes.11.a
    country_event = { id = faction_changes.6 }
  }
}

#Lose Neutrality - VASSAL
country_event = {
  id = faction_changes.12
  title = faction_changes.12.t
  desc = faction_changes.12.d
  picture = SWORD_SHIELD_eventPicture

  major = yes
  trigger = {
    is_subject = true
    has_country_modifier = neutral_member
  }

  mean_time_to_happen = {
    days = 0
  }

  immediate = {
    remove_country_modifier = neutral_member
  }

  option = {
    name = faction_changes.12.a
    country_event = { id = faction_changes.6 }
  }
}

#Trigger these in the death events
#New Alliance Leader
country_event = {
  id = faction_changes.13
  title = faction_changes.13.t
  desc = faction_changes.13.d
  picture = BLIND_PALADIN_eventPicture

  major = yes
  trigger = {
    has_country_modifier = alliance_head
  }

  is_triggered_only = yes
  immediate = {
    remove_country_modifier = alliance_head
    random_country = {
      limit = { has_country_modifier = alliance_member }
      add_country_modifier = {
        name = alliance_head
        duration = -1
      }
      country_event = { faction_changes.14 }
    }
  }

  option = {
    name = faction_changes.13.a
  }
}

#New Horde Leader
country_event = {
  id = faction_changes.14
  title = faction_changes.14.t
  desc = faction_changes.14.d
  picture = ORC_SHAMAN_eventPicture

  major = yes
  trigger = {
    has_country_modifier = horde_head
  }

  is_triggered_only = yes
  immediate = {
    remove_country_modifier = horde_head
    random_country = {
      limit = { has_country_modifier = horde_member }
      add_country_modifier = {
        name = horde_head
        duration = -1
      }
    }
  }

  option = {
    name = faction_changes.14.a
  }
}
