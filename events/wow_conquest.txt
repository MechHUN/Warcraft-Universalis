namespace = wow_conquest

#---------------------------
# Conquest of [From.GetName]
#---------------------------
country_event = {
    id = wow_conquest.1
	title = wow_conquest.1.title
	desc = wow_conquest.1.desc
	picture = ORCISH_INVASION_eventPicture
    
    is_triggered_only = yes

    # ROOT = controller # FROM = province
    
    immediate = {
        add_horde_unity = 1
    }
    
    # ROOT = controller, FROM = 
    
    # Raise the dead
    option = {
		name = wow_conquest.1.option.a

        trigger = {
            government = scourge_gov
        }
        
        FROM = {
            add_permanent_province_modifier = {
                name = battles_raise_the_dead_unrest
                duration = 720
            }
            set_local_autonomy = 75

            raise_the_dead_manpower = yes
        }
        
        ai_chance = {
            factor = 50
            
            # Don't bother with this option if at full manpower
            modifier = {
                factor = 0
                
                manpower_percentage = 1.0
            }
            
            # Make this option very likely whilst on low manpower
            modifier = {
                factor = 2
                
                NOT = { manpower_percentage = 0.25 }
            }
            
            modifier = {
                factor = 0
                has_country_modifier = blood_of_mannaroth
            }
        }
	}
    
    # Slash and Burn
    option = {
		name = wow_conquest.1.option.b
        
        FROM = {
            add_permanent_province_modifier = {
                name = battles_slash_and_burn_unrest
                duration = 720
            }
            add_base_tax = -1
            add_base_production = -1
            add_base_manpower = -1
            set_local_autonomy = 75
        }
        
        ai_chance = {
            factor = 25
            
            # High country unrest means the AI will shy away from taking land this way
            modifier = {
                factor = 0.5
                
                average_unrest = 5
            }
            
            modifier = {
                factor = 0
                has_country_modifier = blood_of_mannaroth
            }
        }
	}
    
    # Take direct control
    option = {
		name = wow_conquest.1.option.c

        FROM = {
            add_permanent_province_modifier = {
                name = battles_direct_control_unrest
                duration = 720
            }
            
            change_culture = ROOT
            change_religion = ROOT
            cede_province = ROOT
            add_core = ROOT
            set_local_autonomy = 100
        }
        
        ai_chance = {
            factor = 5
            
            # Old Horde will always take land
            modifier = {
                factor = 1000
                has_country_modifier = blood_of_mannaroth
            }
            
            # AI will only take over their own cultur/religion
            modifier = {
                factor = 0
                NOT = { has_country_modifier = blood_of_mannaroth }
                FROM = {
                    NOT = { culture = ROOT }
                }    
            }
            
            modifier = {
                factor = 0
                NOT = { has_country_modifier = blood_of_mannaroth }
                FROM = {
                    NOT = { religion = ROOT }
                }    
            }
            
            # High country unrest means the AI will shy away from taking land this way
            modifier = {
                factor = 0.1
                
                average_unrest = 5
            }
        }
	}
    
    # Leave alone
    option = {
		name = wow_conquest.1.option.d

        ai_chance = {
            factor = 25
            
            # Any unrest in the province means the AI will leave it alone most of the time
            modifier = {
                factor = 4
                
                FROM = { unrest = 1 }
            }
            
            modifier = {
                factor = 0
                has_country_modifier = blood_of_mannaroth
            }
        }
	}
}

#---------------------------
# Province Setup
#---------------------------
province_event = {
    id = wow_conquest.2
	title = wow_conquest.2.title
	desc = wow_conquest.2.desc
	picture = ANGRY_MOB_eventPicture # Placeholder
    
    is_triggered_only = yes
    
    hidden = yes
    
    # root = location, from = winning country
    
    trigger = {
        FROM = {
            OR = {
                government = warband_gov
                government = scourge_gov
            }
        }
        NOT = { owned_by = FROM }
    }

    option = {
		name = wow_conquest.1.option.a

        # Pickable event
        if = {
            limit = { 
                is_capital = no
                is_city = yes
                FROM = {
                    AND = {
                        NOT = { has_country_modifier = battles_raise_the_dead }
                        NOT = { has_country_modifier = battles_slash_and_burn }
                        NOT = { has_country_modifier = battles_direct_control }
                        NOT = { has_country_modifier = battles_leave_alone }
                    }
                }
            }
            controller = { country_event = { id = wow_conquest.1 } }  
        }
        
        # Automatic event
        if = {
            limit = { 
                is_capital = no
                is_city = yes
                FROM = {
                    ai = no
                    OR = {
                        has_country_modifier = battles_raise_the_dead
                        has_country_modifier = battles_slash_and_burn
                        has_country_modifier = battles_direct_control
                        has_country_modifier = battles_leave_alone
                    }
                }
            }
            controller = { country_event = { id = wow_conquest.3 } }  
        }
        
        # Capital event
        if = {
            limit = { 
                is_capital = yes
                is_city = yes
            }
            controller = { country_event = { id = wow_conquest.4 } }  
        }
	}
}

#---------------------------
# Automatic Conquest of [From.GetName]
#---------------------------
country_event = {
    id = wow_conquest.3
	title = wow_conquest.1.title
	desc = wow_conquest.1.desc
	picture = ANGRY_MOB_eventPicture # Placeholder
    
    is_triggered_only = yes
    hidden = yes
    
    trigger = {
        ai = no
    }
    
    immediate = {
        add_horde_unity = 1
    }
    
    # Raise the dead
    option = {
		name = wow_conquest.1.option.a

        trigger = {
            has_country_modifier = battles_raise_the_dead
        }
        
        FROM = {
            add_permanent_province_modifier = {
                name = battles_raise_the_dead_unrest
                duration = 720
            }
            set_local_autonomy = 75

            raise_the_dead_manpower = yes
        }
	}
    
    # Slash and Burn
    option = {
		name = wow_conquest.1.option.b
        
        trigger = {
            has_country_modifier = battles_slash_and_burn
        }
        
        FROM = {
            add_permanent_province_modifier = {
                name = battles_slash_and_burn_unrest
                duration = 720
            }
            add_base_tax = -1
            add_base_production = -1
            add_base_manpower = -1
            set_local_autonomy = 75
        }
	}
    
    # Take direct control
    option = {
		name = wow_conquest.1.option.c

        trigger = {
            has_country_modifier = battles_direct_control
        }

        FROM = {
            add_permanent_province_modifier = {
                name = battles_direct_control_unrest
                duration = 720
            }
            change_culture = ROOT
            change_religion = ROOT
            cede_province = ROOT
            add_core = ROOT
            set_local_autonomy = 100
        }
	}
    
    # Leave alone
    option = {
		name = wow_conquest.1.option.d

        trigger = {
            has_country_modifier = battles_leave_alone
        }
	}
}

#---------------------------
# Conquest of [From.GetName], the Capital
#---------------------------
country_event = {
    id = wow_conquest.4
	title = wow_conquest.4.title
	desc = wow_conquest.4.desc
	picture = ORCISH_INVASION_eventPicture # Placeholder
    
    is_triggered_only = yes

    immediate = {
        add_war_exhaustion = -5
    }
    
    option = {
		name = wow_conquest.4.option.a

        add_horde_unity = 25 
	}
}

#---------------------------
# Reclaim
#---------------------------
# TODO: add support for subjects
province_event = {
    id = wow_conquest.5
	title = wow_conquest.5.title
	desc = wow_conquest.5.desc
	picture = KING_LLANE_eventPicture # Placeholder
    
    is_triggered_only = yes
    hidden = yes
    
    trigger = {
        OR = {
            has_province_modifier = battles_direct_control_unrest
            has_province_modifier = battles_slash_and_burn_unrest
            has_province_modifier = battles_raise_the_dead_unrest
        }  
        previous_owner = controller
        is_core = controller
    }
    
    option = {
		name = wow_conquest.5.option.a
        
        hidden_effect = {
            remove_province_modifier = battles_direct_control_unrest
            remove_province_modifier = battles_slash_and_burn_unrest
            remove_province_modifier = battles_raise_the_dead_unrest
        }
        
        cede_province = controller
        change_culture = controller
        change_religion = controller
        add_core = controller
	}
}

#---------------------------
# Auto-convert culture
#---------------------------
province_event = {
    id = wow_conquest.6
	title = wow_conquest.6.title
	desc = wow_conquest.6.desc
	picture = KING_LLANE_eventPicture # Placeholder
    
    is_triggered_only = yes
    hidden = yes
    
    trigger = {
        OR = {
            AND = {
                is_good = yes
                owner = {
                    is_evil = yes
                }
            }
            AND = {
                is_evil = yes
                owner = {
                    is_good = yes
                }
            }
        }
        is_core = owner
    }
    
    option = {
		name = wow_conquest.6.option.a
        
        change_culture = owner
	}
}

#---------------------------
# Decision Event
#---------------------------
country_event = {
    id = wow_conquest.100
	title = wow_conquest.100.title
	desc = wow_conquest.100.desc
	picture = ORCISH_INVASION_eventPicture # Placeholder
    
    is_triggered_only = yes

    immediate = {
        remove_country_modifier = battles_raise_the_dead
        remove_country_modifier = battles_slash_and_burn
        remove_country_modifier = battles_direct_control
        remove_country_modifier = battles_leave_alone
    }
    
    # Raise the dead automatically
    option = {
		name = wow_conquest.100.option.a

        trigger = {
            government = scourge_gov
        }
        
        add_country_modifier = {
            name = battles_raise_the_dead
            duration = -1
        }
	}
    
    # Slash and Burn automatically
    option = {
		name = wow_conquest.100.option.b

        add_country_modifier = {
            name = battles_slash_and_burn
            duration = -1
        }
	}
    
    # Take direct control automatically
    option = {
		name = wow_conquest.100.option.c

        add_country_modifier = {
            name = battles_direct_control
            duration = -1
        }
	}
    
    # Leave alone automatically
    option = {
		name = wow_conquest.100.option.d

        add_country_modifier = {
            name = battles_leave_alone
            duration = -1
        }
	}
    
    # Manual control
    option = {
		name = wow_conquest.100.option.e

        
	}
}
